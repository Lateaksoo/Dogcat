
@{
    var write = ViewData["Write"] as dogcat.Models.Domain.Write;
    long WriteId = write.Id;
    long UserId = write.UserId;
    string Title = write.Title;
    DateTime Time = write.Time;
    string Category = write.Category;
    int ViewCnt = write.ViewCnt;
    string Context = write.Context;
    string WriterNickName = write.NickName;
    string Path = write.RequestPath;
}
@{
    string Nickname = (string)ViewData["Nickname"];
    int userId = (int)ViewData["UserId"];
}
@{
    var comment = ViewData["Comment"] as List<dogcat.Models.Domain.Comment>;
}
@{
    ViewData["Title"] = $"조회 - {Model?.Title}";

    int page = (int)ViewData["page"];
}

<script src="~/js/Board/Detail.js"></script>
<h2>조회 - @Title</h2>
<hr>
@if (write != null)
{
    <div class="mb-3 mt-3 clearfix">
        <span class="float-start me-2">id: @UserId</span>
        <span class="float-end ms-4">작성일: @Time</span>
        <span class="float-end">조회수: @ViewCnt</span>
    </div>

    <section>
        <form method="POST" name="frmDelete" asp-controller="Board" asp-action="Delete">
            <input type="hidden" asp-for="@WriteId">
        </form>
        @if (Path != null)
        {
            <div class="mb-3">
                <img src="@Path" class="img-thumbnail">
            </div>
        }
        <div class="mb-3">
            <label for="name" readonly>작성자:</label>
            <span class="form-control">@WriterNickName</span>
        </div>
        <div class="mb-3 mt-3">
            <label for="title">제목:</label>
            <span class="form-control">@Title</span>
        </div>
        <div class="mb-3 mt-3">
            <label for="category">카테고리:</label>
            <span class="form-control">@Category</span>
        </div>
        <div class="mb-3 mt-3">
            <label for="context">내용:</label>
            <span class="form-control">@Context</span>
        </div>
       @* 글 작성 수정 삭제 목록*@
         <div class="d-flex">
            <a class="btn btn-outline-dark ms-2" asp-controller="Board" asp-action="List" asp-route-page="@(page)">목록</a>
            <a class="btn btn-outline-dark" asp-controller="Board" asp-action="Update" asp-route-id="@WriteId">수정</a>
            <button type="submit" class="btn btn-outline-danger ms-2" id="btnDel" asp-controller="Board" asp-action="Delete" asp-route-id="@WriteId">삭제</button>
        </div>
        @*댓글 작성*@
        <h3>댓글 작성</h3>
        <form method="post" asp-controller="Board" asp-action="AddComment">
            <input type="hidden" name="WriteId" value="@WriteId" />
            <input type="hidden" name="UserId" value="@userId" />
            <input type="hidden" name="NickName" value="@Nickname" />
            <div class="mb-3">
                @*<input type="text" class="form-control" name="NickName" asp-for="@Nickname" readonly />*@
            </div>
            <div class="mb-3">
                <label for="content">댓글 내용:</label>
                <textarea class="form-control" name="Content" rows="3" required></textarea>
            </div>
            <button type="submit" class="btn btn-primary">댓글 작성</button>
        </form>
        @*댓글 테이블*@
        <table>
            <tbody>
                @foreach (var cmt in comment)
                {
                    <tr id="comment-@cmt.Id">
                        <td>@cmt.NickName</td>
                        <td>@cmt.Content</td>
                        <td>@cmt.Time</td>
                        <td>
                            <form method="POST" name="CommentDelete" asp-controller="Board" asp-action="CommentDelete">
                                <input type="hidden" name="id" value="@cmt.Id" />
                                <button type="submit" class="btn btn-outline-danger ms-2" id="btnDeleteComment" data-comment-id="@cmt.Id">삭제</button>
                            </form>
                        </td>
                        <td>
                           <a class="btn btn-outline-dark" asp-controller="Board" asp-action="Update" asp-route-id="@WriteId">수정</a>
                        </td>
                    </tr>
                }
            </tbody>
         
        </table>

 
        <!-- 하단 링크 -->
    </section>
}
else
{
    <script>
        alert("데이터가 없습니다!");
        history.back();
    </script>
}